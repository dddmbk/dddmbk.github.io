(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-global-login"],{"1f44":function(t,e,i){"use strict";i.r(e);var s=i("3f09"),n=i.n(s);for(var a in s)"default"!==a&&function(t){i.d(e,t,(function(){return s[t]}))}(a);e["default"]=n.a},"3f09":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={data:function(){return{type:"login",recaptchaUrl:"",count:60,login:{username:"",password:""},register:{username:"",password:"",nickname:"",inv:"",smsCode:"",smsToken:""},repassword:{username:"",password:"",repassword:""},social:{type:"",token:""},invpass:!1,locked:!1,imgcheck:{locked:!1,img_code:"",token:""},sms:{locked:!1,token:""}}},onShareAppMessage:function(t){return{title:"登录",path:"/pages/global/login"}},computed:{siteName:function(){return this.$store.state.opt.name},token:function(){return this.$store.state.headerToken},loginType:function(){return this.$store.state.opt.loginType},logo:function(){return this.$store.state.opt.logo},bar:function(){return this.$store.state.bar}},methods:{getRecaptchaText:function(){var t=this;uni.request({method:"POST",url:this.$store.state.restUrlNormal+"getRecaptcha",data:{number:4,width:160,height:64},success:function(e){403==e.statusCode?uni.showModal({content:e.data.message,showCancel:!1}):(t.recaptchaUrl=e.data.base,t.imgcheck.token=e.data.token),t.locked=!1}})},getRecaptcha:function(){var t=this;this.$refs.popup.open(),uni.request({method:"POST",url:this.$store.state.restUrlNormal+"getRecaptcha",data:{number:4,width:400,height:180},success:function(e){403==e.statusCode?uni.showModal({content:e.data.message,showCancel:!1}):(t.recaptchaUrl=e.data.base,t.imgcheck.token=e.data.token),t.locked=!1}})},imgCodeCancel:function(){this.$refs.popup.close(),this.sms.locked=!1},imgCodeCheck:function(){var t=this;1!=this.imgcheck.locked&&(this.imgcheck.locked=!0,uni.request({method:"POST",url:this.$store.state.restUrlNormal+"imgCodeCheck",data:{img_code:this.imgcheck.img_code,token:this.imgcheck.token,loginType:"register"==this.type?2:"repasswd"==this.type?3:"resetpass"==this.type?4:1},success:function(e){403==e.statusCode?uni.showModal({content:e.data.message,showCancel:!1}):t.sendCode(),t.imgcheck.locked=!1}}))},sendCode:function(){var t=this;1!=this.sms.locked&&(this.sms.locked=!0,uni.request({method:"POST",url:this.$store.state.restUrlNormal+"sendCode",data:{nickname:this.register.nickname,username:this.register.username,password:this.register.password,code:"",img_code:this.imgcheck.img_code,invitation_code:this.register.inv,token:this.imgcheck.token,smsToken:"",luoToken:"",confirmPassword:"",loginType:"register"==this.type?2:"repasswd"==this.type?3:"resetpass"==this.type?4:1},success:function(e){403==e.statusCode?uni.showModal({content:e.data.message,showCancel:!1}):(t.register.smsToken=e.data.token,t.countdown(),t.$refs.popup.close())}}))},countdown:function(){var t=this;if(this.count<=1)return this.count=60,void(this.sms.locked=!1);this.count--,setTimeout((function(){t.countdown()}),1e3)},repasswd:function(){this.type="repasswd"==this.type?this.type="register":this.type="repasswd","repasswd"!=this.type?("register"!=this.type&&(this.invpass=!1),"register"==this.type&&this.invpass&&this.getRecaptchaText()):uni.showModal({content:"暂未开通密码找回，可暂时前往PC端操作，敬请期待。",showCancel:!1})},changeType:function(){this.type="login"==this.type?"register":"login","register"!=this.type&&(this.invpass=!1),"register"!=this.type||this.invpass||this.getRecaptchaText()},checkInv:function(){var t=this;1!=this.locked&&(this.locked=!0,uni.request({method:"POST",url:this.$store.state.restUrlNormal+"invitationCheck",data:{code:this.register.inv},success:function(e){403==e.statusCode?uni.showModal({content:e.data.message,showCancel:!1}):(uni.showToast({title:"提交成功",icon:"success",duration:1e3}),t.social.type?t.socialInvLogin("action"):setTimeout((function(){t.invpass=!0}),1e3)),t.locked=!1}}))},action:function(){var t=this;1!=this.locked&&(this.locked=!0,"login"==this.type?uni.request({method:"POST",url:this.$store.state.restwp+"jwt-auth/v1/token",data:{username:this.login.username,password:this.login.password},success:function(e){403==e.statusCode?uni.showModal({content:"账户或密码错误",showCancel:!1}):t.back(e.data),t.locked=!1}}):"register"==this.type&&uni.request({method:"POST",url:this.$store.state.restUrlNormal+"regeister",data:{nickname:this.register.nickname,username:this.register.username,password:this.register.password,code:this.register.smsCode,img_code:"text"==this.loginType.type?this.register.smsCode:this.imgcheck.img_code,invitation_code:this.register.inv,token:this.imgcheck.token,smsToken:this.register.smsToken,luoToken:"",confirmPassword:"",loginType:"register"==this.type?2:"repasswd"==this.type?3:"resetpass"==this.type?4:1},success:function(e){403==e.statusCode?uni.showModal({content:e.data.message,showCancel:!1}):t.back(e.data.msg),t.locked=!1}}))},back:function(t){this.$store.commit("setToken",t.token),this.$store.commit("setUserData",t),this.goback()},invpassAction:function(t){this.social.type?this.socialInvLogin(t):(this.invpass=!0,this.getRecaptchaText())},sLogin:function(t){var e=this;this.socialLogin(t).then((function(t){"invitation"==t.data.type?(e.type="register",e.social=t.data):e.back(t.data)}))},socialInvLogin:function(e){var i=this;uni.request({method:"POST",url:this.$store.state.restUrlNormal+"invRegeister",data:{token:this.social.token,invitation:this.register.inv,subType:e},success:function(e){t.log(e),403==e.statusCode?uni.showModal({content:e.data.message,showCancel:!1}):i.back(e.data)}})}}};e.default=i}).call(this,i("5a52")["default"])},"6ec7":function(t,e,i){"use strict";i.r(e);var s=i("ed94"),n=i("1f44");for(var a in n)"default"!==a&&function(t){i.d(e,t,(function(){return n[t]}))}(a);i("729d");var o,r=i("f0c5"),c=Object(r["a"])(n["default"],s["b"],s["c"],!1,null,"5dfb5069",null,!1,s["a"],o);e["default"]=c.exports},"729d":function(t,e,i){"use strict";var s=i("d252"),n=i.n(s);n.a},d252:function(t,e,i){var s=i("d3ce");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var n=i("4f06").default;n("37d05b62",s,!0,{sourceMap:!1,shadowMode:!1})},d3ce:function(t,e,i){var s=i("24fb");e=s(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.text-r[data-v-5dfb5069]{width:%?190?%;height:%?68?%;margin-right:%?16?%;display:block}.circle-menu[data-v-5dfb5069]{position:fixed;left:0;right:0;top:0;z-index:5;z-index:66;background-color:#fff;display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center;padding-right:%?32?%;padding-left:%?32?%;-webkit-box-sizing:border-box;box-sizing:border-box}.c-title[data-v-5dfb5069]{font-weight:700;margin-bottom:%?40?%}.c-desc[data-v-5dfb5069]{display:block;text-align:center}.c-img[data-v-5dfb5069]{width:%?400?%;height:%?180?%;display:block;-webkit-border-radius:%?10?%;border-radius:%?10?%}.c-img-box[data-v-5dfb5069]{margin:%?32?% 0;width:%?400?%;height:%?180?%;background-color:#efefef;-webkit-border-radius:%?10?%;border-radius:%?10?%}.cp-step[data-v-5dfb5069]{background-color:#fff;width:100%;display:block;padding:%?80?% 0 %?200?% 0}.cp-step .inp[data-v-5dfb5069]{width:100%;height:%?100?%;padding:0 %?38?%;background-color:#efefef;margin:%?32?% 0;font-size:%?60?%;text-align:center;letter-spacing:%?20?%;-webkit-box-sizing:border-box;box-sizing:border-box}.c-action[data-v-5dfb5069]{-webkit-box-pack:justify;justify-content:space-between;margin-top:%?60?%;width:100%}.c-button[data-v-5dfb5069]{font-size:%?28?%;height:%?70?%;line-height:%?70?%;margin:0}.can-button[data-v-5dfb5069]{background:none!important;color:#999!important;font-size:%?28?%;height:%?70?%;line-height:%?70?%;margin:0}.cp-step-in[data-v-5dfb5069]{max-width:%?400?%;margin:0 auto;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-flow:column}.e-row[data-v-5dfb5069]{-webkit-box-align:center;align-items:center}.e-row.row .inp[data-v-5dfb5069]{background:none;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;margin:4px 0!important}.c-input[data-v-5dfb5069]{width:calc(100% - %?190?%)}.e-row.row .flex-center[data-v-5dfb5069]{background-color:#efefef}.e-row .desc[data-v-5dfb5069]{text-align:left}.e-row .cap[data-v-5dfb5069]{width:%?190?%;font-size:%?24?%;margin-right:%?16?%;height:%?68?%;line-height:%?68?%;padding:0 %?24?%}.l-top[data-v-5dfb5069]{font-size:%?60?%}.login-page[data-v-5dfb5069]{height:100%;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-flow:column;margin:0 %?80?%}.form-box[data-v-5dfb5069]{width:100%;-webkit-box-flex:1;flex:1}.l-form[data-v-5dfb5069], .l-picke[data-v-5dfb5069], .l-bottom[data-v-5dfb5069]{max-width:%?600?%;width:100%}.row[data-v-5dfb5069]{margin:%?30?% 0}.row .p[data-v-5dfb5069]{margin-bottom:%?10?%;font-size:%?30?%;font-weight:700}.l-picke[data-v-5dfb5069]{color:#1985ff;-webkit-box-pack:justify;justify-content:space-between;width:100%}.row .inp[data-v-5dfb5069]{display:block;font-size:%?32?%;height:%?80?%;line-height:%?80?%;background-color:#efefef;-webkit-border-radius:%?8?%;border-radius:%?8?%;padding:%?8?% %?32?%!important}.l-bottom[data-v-5dfb5069]{margin-top:%?40?%}.desc[data-v-5dfb5069]{font-size:%?26?%;text-align:right;margin-top:%?4?%}.l-bottom uni-button[data-v-5dfb5069]{width:100%;padding:%?16?%;font-size:%?28?%;background-color:#1985ff;border-color:#1985ff}.social[data-v-5dfb5069]{margin-bottom:%?80?%;color:#1985ff;display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center}.social .empty[data-v-5dfb5069], .soc-img[data-v-5dfb5069]{width:%?80?%;height:%?80?%;display:block}.social-box[data-v-5dfb5069]{text-align:center}.social .empty[data-v-5dfb5069]{margin:0 %?40?%}.soc-img[data-v-5dfb5069]{position:absolute;top:0;left:0}.social .empty[data-v-5dfb5069]::after{border:0}.type-text[data-v-5dfb5069]{font-size:%?28?%;font-weight:700;letter-spacing:%?10?%;margin-bottom:%?40?%;margin-top:%?20?%;text-align:center}.inv-button .empty[data-v-5dfb5069]::after{border:0}.inv-button-box[data-v-5dfb5069]{-webkit-box-pack:justify;justify-content:space-between}.inv-box[data-v-5dfb5069]{text-align:center}',""]),t.exports=e},ed94:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return s}));var s={uniPopup:i("33bf").default},n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"login-page flex-center"},[i("v-uni-view",{staticClass:"circle-menu fs15",style:"height:"+t.bar.height+"px;padding-top:"+t.bar.top+"px"},[i("v-uni-view",{staticClass:"c-header-left",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goback.apply(void 0,arguments)}}},[i("b2font",{attrs:{type:"b2arrow-left-s-line",size:"50"}})],1),i("v-uni-view",{staticClass:"c-header-center"}),i("v-uni-view",{staticClass:"c-header-right",style:"padding-right:"+t.bar.width+"px"})],1),i("v-uni-view",{staticClass:"l-top",style:"padding-top:"+t.bar.height+"px"},[t._v(t._s(t.siteName))]),i("v-uni-form",{staticClass:"form-box",on:{submit:function(e){arguments[0]=e=t.$handleEvent(e),t.action.apply(void 0,arguments)}}},[i("v-uni-input",{staticStyle:{display:"none"},attrs:{type:"password"}}),i("v-uni-view",{staticClass:"type-text b2color"},["login"==t.type?i("v-uni-view",[t._v("登陆")]):"register"==t.type?i("v-uni-view",[t._v("注册")]):"repasswd"==t.type?i("v-uni-view",[t._v("找回密码")]):t._e()],1),"login"==t.type?i("v-uni-view",{staticClass:"l-form"},[i("v-uni-view",{staticClass:"row"},[i("v-uni-view",{staticClass:"p",domProps:{textContent:t._s(t.loginType.text)}}),i("v-uni-input",{staticClass:"inp",attrs:{name:"username",type:"text"},model:{value:t.login.username,callback:function(e){t.$set(t.login,"username",e)},expression:"login.username"}})],1),i("v-uni-view",{staticClass:"row"},[i("v-uni-view",{staticClass:"p"},[t._v("密码")]),i("v-uni-input",{staticClass:"inp",attrs:{name:"password",type:"password"},model:{value:t.login.password,callback:function(e){t.$set(t.login,"password",e)},expression:"login.password"}}),i("v-uni-view",{staticClass:"desc gray"},[t._v("大于6个字符")])],1)],1):"register"==t.type?i("v-uni-view",{staticClass:"l-form"},[0==t.loginType.inv.type||t.invpass?i("v-uni-view",[i("v-uni-view",{staticClass:"row"},[i("v-uni-view",{staticClass:"p"},[t._v("可爱的昵称")]),i("v-uni-input",{staticClass:"inp",attrs:{type:"text"},model:{value:t.register.nickname,callback:function(e){t.$set(t.register,"nickname",e)},expression:"register.nickname"}}),i("v-uni-view",{staticClass:"desc gray"},[t._v("中文或字母，不可使用特殊字符")])],1),i("v-uni-view",{staticClass:"row"},[i("v-uni-view",{staticClass:"p",domProps:{textContent:t._s(t.loginType.text)}}),i("v-uni-input",{staticClass:"inp",attrs:{type:"text"},model:{value:t.register.username,callback:function(e){t.$set(t.register,"username",e)},expression:"register.username"}}),"text"==t.loginType.type?i("v-uni-view",{staticClass:"desc gray"},[t._v("请使用英文或数字")]):t._e()],1),i("v-uni-view",{staticClass:"row e-row b2radius"},[i("v-uni-view",{staticClass:"flex-center"},[i("v-uni-view",{staticClass:"c-input"},["checkbox"===("text"==t.loginType.type?"text":"number")?i("v-uni-input",{staticClass:"inp",attrs:{placeholder:"验证码",type:"checkbox"},model:{value:t.register.smsCode,callback:function(e){t.$set(t.register,"smsCode",e)},expression:"register.smsCode"}}):"radio"===("text"==t.loginType.type?"text":"number")?i("input",{directives:[{name:"model",rawName:"v-model",value:t.register.smsCode,expression:"register.smsCode"}],staticClass:"inp",attrs:{placeholder:"验证码",type:"radio"},domProps:{checked:t._q(t.register.smsCode,null)},on:{change:function(e){return t.$set(t.register,"smsCode",null)}}}):i("input",{directives:[{name:"model",rawName:"v-model",value:t.register.smsCode,expression:"register.smsCode"}],staticClass:"inp",attrs:{placeholder:"验证码",type:"text"==t.loginType.type?"text":"number"},domProps:{value:t.register.smsCode},on:{input:function(e){e.target.composing||t.$set(t.register,"smsCode",e.target.value)}}})],1),"tel"==t.loginType.type||"email"==t.loginType.type||"telandemail"==t.loginType.type?i("v-uni-button",{staticClass:"cap",attrs:{size:"mini",disabled:t.sms.locked||!t.register.username},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getRecaptcha.apply(void 0,arguments)}}},[t._v(t._s(t.sms.locked?t.count+"秒后重新发送":"获取验证码"))]):t._e(),"text"==t.loginType.type?i("v-uni-view",{staticClass:"text-r"},[i("v-uni-image",{staticClass:"text-r",attrs:{src:t.recaptchaUrl,mode:"aspectFit"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getRecaptchaText.apply(void 0,arguments)}}})],1):t._e()],1)],1),i("v-uni-view",{staticClass:"row"},[i("v-uni-view",{staticClass:"p"},[t._v("密码")]),i("v-uni-input",{staticClass:"inp",attrs:{type:"password"},model:{value:t.register.password,callback:function(e){t.$set(t.register,"password",e)},expression:"register.password"}}),i("v-uni-view",{staticClass:"desc gray"},[t._v("大于6个字符")])],1)],1):i("v-uni-view",{staticClass:"inv-box"},[1==t.loginType.inv.type?i("v-uni-view",{staticClass:"row"},[t._v("使用邀请码，获取积分奖励！")]):t._e(),i("v-uni-view",{staticClass:"row"},[i("v-uni-view",{staticClass:"gray fs14 mg-b"},[t._v("请输入邀请码")]),i("v-uni-input",{staticClass:"inp",attrs:{type:"text",autocomplete:"new-password"},model:{value:t.register.inv,callback:function(e){t.$set(t.register,"inv",e)},expression:"register.inv"}})],1)],1)],1):i("v-uni-view",{staticClass:"l-form"},[i("v-uni-view",{staticClass:"row forgot"},[i("v-uni-view",{staticClass:"p",domProps:{textContent:t._s(t.loginType.text)}}),i("v-uni-input",{staticClass:"inp",attrs:{type:"text"},model:{value:t.repassword.username,callback:function(e){t.$set(t.repassword,"username",e)},expression:"repassword.username"}}),i("v-uni-view",{staticClass:"desc gray"},[t._v("请输入您的"+t._s(t.loginType.text))])],1)],1),t.invpass||"register"!=t.type||0==t.loginType.inv.type?[i("v-uni-view",{staticClass:"l-picke flex-center"},[0!=t.loginType.inv.type&&"register"==t.type?i("v-uni-view",[i("v-uni-text",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.invpass=!1}}},[t._v("修改邀请码")])],1):i("v-uni-view",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.repasswd.apply(void 0,arguments)}}},["repasswd"==t.type?i("v-uni-text",[t._v("快速注册")]):i("v-uni-text",[t._v("忘记密码？")])],1),i("v-uni-view",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeType.apply(void 0,arguments)}}},[t._v(t._s("login"==t.type?"快速注册":"登陆"))])],1),i("v-uni-view",{staticClass:"l-bottom"},[i("v-uni-button",{attrs:{type:"primary",size:"md",disabled:t.locked||"repasswd"==t.type,"form-type":"submit"}},["login"==t.type?i("v-uni-text",[t._v("登陆")]):"repasswd"==t.type?i("v-uni-text",[t._v("找回密码")]):i("v-uni-text",[t._v("快速注册")])],1)],1)]:i("v-uni-view",{staticClass:"flex-center inv-button-box fs15"},[t.loginType.inv.link.id?i("v-uni-view",{staticClass:"red",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.go("/pages/single/"+t.loginType.inv.link.post_type+"?id="+t.loginType.inv.link.id)}}},[t._v(t._s(t.loginType.inv.text))]):t._e(),i("v-uni-view",{staticClass:"inv-button flex-center"},[1==t.loginType.inv.type?i("v-uni-button",{staticClass:"empty",attrs:{size:"mini"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.invpassAction("pass")}}},[t._v("跳过")]):t._e(),i("v-uni-button",{attrs:{size:"mini"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.checkInv.apply(void 0,arguments)}}},[t._v("提交")])],1)],1)],2),i("uni-popup",{ref:"popup",attrs:{type:"top"}},[i("v-uni-view",{staticClass:"cp-step"},[i("v-uni-view",{staticClass:"cp-step-in flex-center"},[i("v-uni-view",{staticClass:"c-title"},[t._v("你是机器人吗？")]),i("v-uni-view",{staticClass:"c-img-box"},[t.recaptchaUrl?i("v-uni-image",{staticClass:"c-img",attrs:{src:t.recaptchaUrl,mode:"aspectFit"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getRecaptcha.apply(void 0,arguments)}}}):t._e()],1),i("v-uni-view",{staticClass:"fs14 gray"},[i("v-uni-text",{staticClass:"c-desc"},[t._v("请输入图片中的验证码")]),i("v-uni-text",{staticClass:"c-desc"},[t._v("点击「我是人类」按钮获取验证码")])],1),i("v-uni-input",{staticClass:"inp",attrs:{type:"text"},model:{value:t.imgcheck.img_code,callback:function(e){t.$set(t.imgcheck,"img_code",e)},expression:"imgcheck.img_code"}}),i("v-uni-view",{staticClass:"flex-center c-action"},[i("v-uni-button",{staticClass:"can-button",attrs:{type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.imgCodeCancel.apply(void 0,arguments)}}},[t._v("取消")]),i("v-uni-button",{staticClass:"c-button",attrs:{disabled:t.imgcheck.locked||4!=t.imgcheck.img_code.length},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.imgCodeCheck.apply(void 0,arguments)}}},[t._v("我是人类")])],1)],1)],1)],1)],1)},a=[]}}]);